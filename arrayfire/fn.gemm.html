<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `gemm` fn in crate `arrayfire`."><meta name="keywords" content="rust, rustlang, rust-lang, gemm"><title>arrayfire::gemm - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="http://www.rust-lang.org/favicon.ico"><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../arrayfire/index.html'><div class='logo-container'><img src='http://www.arrayfire.com/logos/arrayfire_logo_symbol.png' alt='logo'></div></a><div class="sidebar-elems"><p class='location'><a href='index.html'>arrayfire</a></p><script>window.sidebarCurrent = {name: 'gemm', ty: 'fn', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/arrayfire/blas/mod.rs.html#122-147' title='goto source code'>[src]</a></span><span class='in-band'>Function <a href='index.html'>arrayfire</a>::<wbr><a class="fn" href=''>gemm</a></span></h1><pre class='rust fn'>pub fn gemm&lt;T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;output: &amp;mut <a class="struct" href="../arrayfire/struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;optlhs: <a class="enum" href="../arrayfire/enum.MatProp.html" title="enum arrayfire::MatProp">MatProp</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;optrhs: <a class="enum" href="../arrayfire/enum.MatProp.html" title="enum arrayfire::MatProp">MatProp</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;alpha: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;lhs: &amp;<a class="struct" href="../arrayfire/struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;rhs: &amp;<a class="struct" href="../arrayfire/struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;beta: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;T&gt;<br>) <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="../arrayfire/trait.HasAfEnum.html" title="trait arrayfire::HasAfEnum">HasAfEnum</a> + <a class="trait" href="../arrayfire/trait.FloatingPoint.html" title="trait arrayfire::FloatingPoint">FloatingPoint</a>,&nbsp;</span></pre><div class='docblock'><p>BLAS general matrix multiply (GEMM) of two Array objects</p>
<p>This provides a general interface to the BLAS level 3 general matrix multiply (GEMM),
which is generally defined as:</p>
<p>\begin{equation}
C = \alpha * opA(A)opB(B) + \beta * C
\end{equation}</p>
<p>where $\alpha$ (<strong>alpha</strong>) and $\beta$ (<strong>beta</strong>) are both scalars; $A$ and $B$ are the matrix
multiply operands; and $opA$ and $opB$ are noop
(if optLhs is <a href="./enum.MatProp.html">MatProp::NONE</a>) or transpose
(if optLhs is <a href="./enum.MatProp.html">MatProp::TRANS</a>) operations on $A$ or $B$ before the
actual GEMM operation. Batched GEMM is supported if at least either $A$ or $B$ have more than
two dimensions (see <a href="http://arrayfire.org/docs/group__blas__func__matmul.htm#ga63306b6ed967bd1055086db862fe885b">af::matmul</a>
for more details on broadcasting). However, only one <strong>alpha</strong> and one <strong>beta</strong> can be used
for all of the batched matrix operands.</p>
<p>The <code>output</code> Array can be used both as an input and output. An allocation will be performed
if you pass an empty Array (i.e. <code>let c: Array&lt;f32&gt; = (0 as i64).into();</code>). If a valid Array
is passed as $C$, the operation will be performed on that Array itself. The C Array must be
the correct type and shape; otherwise, an error will be thrown.</p>
<p>Note: Passing an Array that has not been initialized to the C array
will cause undefined behavior.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>Given below is an example of using gemm API with existing Arrays</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">arrayfire</span>::{<span class="ident">Array</span>, <span class="ident">Dim4</span>, <span class="ident">print</span>, <span class="ident">randu</span>, <span class="ident">gemm</span>};

<span class="kw">let</span> <span class="ident">dims</span> <span class="op">=</span> <span class="ident">Dim4</span>::<span class="ident">new</span>(<span class="kw-2">&amp;</span>[<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>]);

<span class="kw">let</span> <span class="ident">alpha</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[<span class="number">1.0</span> <span class="kw">as</span> <span class="ident">f32</span>];
<span class="kw">let</span>  <span class="ident">beta</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[<span class="number">2.0</span> <span class="kw">as</span> <span class="ident">f32</span>];

<span class="kw">let</span> <span class="ident">lhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);
<span class="kw">let</span> <span class="ident">rhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">Array</span>::<span class="ident">new_empty</span>(<span class="ident">dims</span>);
<span class="ident">gemm</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">result</span>, <span class="ident">arrayfire</span>::<span class="ident">MatProp</span>::<span class="ident">NONE</span>, <span class="ident">arrayfire</span>::<span class="ident">MatProp</span>::<span class="ident">NONE</span>,
     <span class="ident">alpha</span>, <span class="kw-2">&amp;</span><span class="ident">lhs</span>, <span class="kw-2">&amp;</span><span class="ident">rhs</span>, <span class="ident">beta</span>);</pre></div>
<p>If you don't have an existing Array, you can also use gemm in the following fashion.
However, if there is no existing Array that you need to fill and your use case doesn't
deal with alpha and beta from gemm equation, it is recommended to use
<a href="./fn.matmul.html">matmul</a> for more terse code.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">arrayfire</span>::{<span class="ident">Array</span>, <span class="ident">Dim4</span>, <span class="ident">af_array</span>, <span class="ident">print</span>, <span class="ident">randu</span>, <span class="ident">gemm</span>};

<span class="kw">let</span> <span class="ident">dims</span> <span class="op">=</span> <span class="ident">Dim4</span>::<span class="ident">new</span>(<span class="kw-2">&amp;</span>[<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>]);

<span class="kw">let</span> <span class="ident">alpha</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[<span class="number">1.0</span> <span class="kw">as</span> <span class="ident">f32</span>];
<span class="kw">let</span>  <span class="ident">beta</span> <span class="op">=</span> <span class="macro">vec</span><span class="macro">!</span>[<span class="number">2.0</span> <span class="kw">as</span> <span class="ident">f32</span>];

<span class="kw">let</span> <span class="ident">lhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);
<span class="kw">let</span> <span class="ident">rhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">result</span>: <span class="ident">Array</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="ident">std</span>::<span class="ident">ptr</span>::<span class="ident">null_mut</span>() <span class="kw">as</span> <span class="ident">af_array</span>).<span class="ident">into</span>();

<span class="ident">gemm</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">result</span>, <span class="ident">arrayfire</span>::<span class="ident">MatProp</span>::<span class="ident">NONE</span>, <span class="ident">arrayfire</span>::<span class="ident">MatProp</span>::<span class="ident">NONE</span>,
     <span class="ident">alpha</span>, <span class="kw-2">&amp;</span><span class="ident">lhs</span>, <span class="kw-2">&amp;</span><span class="ident">rhs</span>, <span class="ident">beta</span>);</pre></div>
<h1 id="parameters" class="section-header"><a href="#parameters">Parameters</a></h1>
<ul>
<li><code>optlhs</code> - Transpose left hand side before the function is performed, uses one of the values of <a href="./enum.MatProp.html">MatProp</a></li>
<li><code>optrhs</code> - Transpose right hand side before the function is performed, uses one of the values of <a href="./enum.MatProp.html">MatProp</a></li>
<li><code>alpha</code> is alpha value;</li>
<li><code>lhs</code> is the Array on left hand side</li>
<li><code>rhs</code> is the Array on right hand side</li>
<li><code>beta</code> is beta value;</li>
</ul>
<h1 id="return-values" class="section-header"><a href="#return-values">Return Values</a></h1>
<p>Array, result of gemm operation</p>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "arrayfire";</script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>